<!DOCTYPE html>
<html>

<head>
  <title>Shipment Info</title>
</head>

<body>
  <h1>Shipment File Info</h1>
  <p><strong>Operator:</strong> {{ operator }}</p>

  <h2>Sheets:</h2>
  <ul>
    {% for sheet in sheet_names %}
    <li>{{ sheet }}</li>
    {% endfor %}
  </ul>

  {% if documents %}
  <h2>Valid Vessel Documents</h2>
  {% for category, items in documents|groupby("category.name") %}
  <h3>{{ category }}</h3>
  <ul>
    {% for doc in items %}
    <li>
      <strong>Provider:</strong> {{ doc.provider.name if doc.provider else 'N/A' }}<br>
      <strong>Number:</strong> {{ doc.number or 'N/A' }}<br>
      <strong>Date:</strong> {{ doc.date.strftime('%Y-%m-%d') }}<br>
      {% if doc.category.value == 'Class Certificate' %}
      <strong>Provider Agreed:</strong>
      {% if doc.provider_agreed %}
      Yes
      {% else %}
      No
      {% endif %}
      {% endif %}
    </li>
    {% endfor %}
  </ul>
  {% endfor %}
  {% else %}
  <h2>No valid vessel documents found.</h2>
  {% endif %}
</body>

</html>